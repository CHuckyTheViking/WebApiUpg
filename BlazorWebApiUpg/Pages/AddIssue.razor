@page "/add"
<h3>Add Issue</h3>

<RadzenFieldset Text="Add Issue">
    <div class="row">
        <div class="col-md-4 align-items-center d-flex">
            <RadzenLabel Text="Information" />
        </div>
        <div class="col-md-8">
            <RadzenTextArea style="width: 100%;" Name="Information" />
        </div>

        <div class="col-md-4 align-items-center d-flex">
            <RadzenLabel Text="Customer" />
        </div>
        <div class="col-md-8">
            <RadzenDropDown @bind-Value="issue.CustomerId" Placeholder="Customer" Data="@customers" style="width: 100%;" TextProperty="Name" ValueProperty="Id" Name="Customer">
            </RadzenDropDown>
        </div>
        <div class="col-md-4 align-items-center d-flex">
            <RadzenLabel Text="Created By" />
        </div>
        <div class="col-md-8">
            <RadzenDropDown @bind-Value="issue.UserId" Placeholder="User" Data="@users" style="width: 100%;" TextProperty="DisplayName" ValueProperty="Id" Name="Created By">
            </RadzenDropDown>
        </div>
        <div class="col-md-4 align-items-center d-flex">
            <RadzenLabel Text="Status" />
        </div>
        <div class="col-md-8">
            <RadzenDropDown @bind-Value="issue.Status" Placeholder="Status" Data="@status" style="width: 100%;" TextProperty="Status" ValueProperty="Status" Name="Status">
            </RadzenDropDown>
        </div>


    </div>
    
</RadzenFieldset>



@code {
    private SD.Issue issue { get; set; }
    private IEnumerable<SD.Customer> customers;
    private IEnumerable<SD.User> users;
    private List<SD.Issue> status;

    protected override async Task OnInitializedAsync()
    {
        issue = new SD.Issue();
        status = new List<SD.Issue>();
        await LoadAllAsync();

    }

    private async Task LoadAllAsync()
    {

        customers = await Http.GetFromJsonAsync<IEnumerable<SD.Customer>>("https://localhost:44374/api/Customers/all");
        users = await Http.GetFromJsonAsync<IEnumerable<SD.User>>("https://localhost:44374/api/Users/all");

        var status1 = new SD.Issue
        {
            Status = "Not Started"
        };
        var status2 = new SD.Issue
        {
            Status = "Started"
        };
        var status3 = new SD.Issue
        {
            Status = "Finished"
        };

        status.Add(status1);
        status.Add(status2);
        status.Add(status3);
    }

}
